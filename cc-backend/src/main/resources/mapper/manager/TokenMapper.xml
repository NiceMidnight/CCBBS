<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cc.backend.common.token.TokenMapper">

    <select id="selectRedisKey" parameterType="user" resultType="java.lang.String">
        SELECT redis_key
        FROM token
        WHERE user_id = #{user.id} AND user_name = #{user.userName} AND token_status = #{tokenStatus}
    </select>

    <update id="updateTokenStatus">
        UPDATE token
        SET token_status = #{tokenStatus}
        WHERE user_id = #{user.id} AND user_name = #{user.userName} AND token_status = #{status}
    </update>

    <update id="updateTokenStatusByRedisKey">
        UPDATE token
        SET token_status = #{tokenStatus}
        WHERE redis_key = #{redisKey}
    </update>

</mapper>